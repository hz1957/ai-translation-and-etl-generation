{
  "uId": null,
  "dataFlowId": "genai_etl_config_1756272056325",
  "domId": "clinical_data",
  "name": "受试者最新不良事件与年龄关联",
  "description": "关联CDASH_DM和CDASH_AE数据集，获取每个受试者的年龄及其最新的不良事件（按开始日期降序取第一条）",
  "meta": [
    {
      "type": "INPUT_DATASET",
      "name": "CDASH_AE",
      "displayType": "CSV",
      "preview": { "scope": "ALL", "config": {} },
      "cascadeUpdateEnabled": false,
      "inputDsId": "facddcc2ccc8f4be4823c07b",
      "id": "id_1756272056325",
      "position": { "x": 667, "y": -82 },
      "sources": []
    },
    {
      "type": "INPUT_DATASET",
      "name": "CDASH_LB",
      "displayType": "CSV",
      "preview": { "scope": "ALL", "config": {} },
      "cascadeUpdateEnabled": false,
      "inputDsId": "v1e6db5955b28425c8da6f9a",
      "id": "id_1756272072199",
      "position": { "x": 670, "y": 50 },
      "sources": []
    },
    {
      "type": "INPUT_DATASET",
      "name": "CDASH_DM",
      "displayType": "CSV",
      "preview": { "scope": "ALL", "config": {} },
      "cascadeUpdateEnabled": false,
      "inputDsId": "d1eb397adbf35428eaa15793",
      "id": "id_1756272073121",
      "position": { "x": 669, "y": 182 },
      "sources": []
    },
    {
      "type": "CALCULATOR",
      "name": "添加排序字段",
      "id": "calc_latest_ae",
      "formulas": [
        {
          "name": "AE_Rank",
          "type": "INT",
          "expr": "row_number() over(partition by [受试者] order by [开始日期] desc)",
          "key": "ae_rank_key"
        }
      ],
      "position": { "x": 800, "y": -82 },
      "sources": ["id_1756272056325"]
    },
    {
      "type": "FILTER_ROWS",
      "name": "筛选最新不良事件",
      "id": "filter_latest_ae",
      "conditions": [
        {
          "name": "AE_Rank",
          "fdType": "INT",
          "filterType": "EQ",
          "filterValue": [{"v": "1", "type": "VALUE"}]
        }
      ],
      "combineType": "AND",
      "position": { "x": 950, "y": -82 },
      "sources": ["calc_latest_ae"]
    },
    {
      "type": "JOIN_DATA",
      "name": "关联受试者年龄",
      "id": "join_dm_ae",
      "dataFusion": {
        "dataSources": [
          { "key": "filter_latest_ae" },
          { "key": "id_1756272073121" }
        ],
        "fusionType": "COLUMN",
        "columnFuses": [
          {
            "leftKey": "filter_latest_ae",
            "rightKey": "id_1756272073121",
            "joinType": "LEFT_OUTER",
            "predicates": [
              {
                "leftColumn": "受试者",
                "rightColumn": "受试者"
              }
            ]
          }
        ],
        "selectedColumns": [
          {
            "name": "受试者",
            "dsKey": "filter_latest_ae",
            "isIgnored": false
          },
          {
            "name": "年龄",
            "dsKey": "id_1756272073121",
            "isIgnored": false
          },
          {
            "name": "不良事件名称",
            "dsKey": "filter_latest_ae",
            "isIgnored": false
          }
        ]
      },
      "position": { "x": 1100, "y": 50 },
      "sources": ["filter_latest_ae", "id_1756272073121"]
    },
    {
      "type": "SELECT_COLUMNS",
      "name": "选择输出字段",
      "id": "select_final_fields",
      "columns": [
        {
          "name": "受试者",
          "dsKey": "join_dm_ae",
          "isIgnored": false
        },
        {
          "name": "年龄",
          "dsKey": "join_dm_ae",
          "isIgnored": false
        },
        {
          "name": "不良事件名称",
          "dsKey": "join_dm_ae",
          "isIgnored": false
        }
      ],
      "position": { "x": 1250, "y": 50 },
      "sources": ["join_dm_ae"]
    },
    {
      "type": "OUTPUT_DATASET",
      "name": "受试者最新不良事件与年龄",
      "id": "output_final",
      "outputDsName": "Subject_Latest_AE_With_Age",
      "parentDirId": "output_folder_clinical",
      "dataSource": {
        "created": true,
        "dsId": "output_ds_001",
        "name": "Subject_Latest_AE_With_Age",
        "dirPath": [
          { "dirId": "root_dir", "dirName": "根目录" },
          { "dirId": "clinical_dir", "dirName": "临床数据" }
        ]
      },
      "position": { "x": 1400, "y": 50 },
      "sources": ["select_final_fields"]
    }
  ],
  "inputs": [
    {
      "dsId": "facddcc2ccc8f4be4823c07b",
      "name": "CDASH_AE",
      "fields": [
        { "name": "研究中心", "type": "STRING", "seqNo": 0 },
        { "name": "中心编号", "type": "LONG", "seqNo": 1 },
        { "name": "受试者", "type": "STRING", "seqNo": 2 },
        { "name": "页面名称", "type": "STRING", "seqNo": 3 },
        { "name": "记录号", "type": "LONG", "seqNo": 4 },
        { "name": "不良事件名称", "type": "STRING", "seqNo": 5 },
        { "name": "开始日期", "type": "DATE", "seqNo": 6 },
        { "name": "开始时间", "type": "STRING", "seqNo": 7 },
        { "name": "结束日期", "type": "DATE", "seqNo": 8 },
        { "name": "结束时间", "type": "STRING", "seqNo": 9 },
        { "name": "AE分类", "type": "STRING", "seqNo": 10 },
        { "name": "是否为严重不良事件", "type": "STRING", "seqNo": 11 },
        { "name": "是否为限制性毒性事件", "type": "STRING", "seqNo": 12 },
        { "name": "严重程度（CTCAE）", "type": "STRING", "seqNo": 13 },
        { "name": "与研究用药的因果关系", "type": "STRING", "seqNo": 14 },
        { "name": "是否因严重不良事件退出试验", "type": "STRING", "seqNo": 15 },
        { "name": "IrAE", "type": "STRING", "seqNo": 16 },
        { "name": "是否导致药物暂停", "type": "STRING", "seqNo": 17 },
        { "name": "是否导致药物降低剂量", "type": "STRING", "seqNo": 18 },
        { "name": "是否导致永久停药", "type": "STRING", "seqNo": 19 }
      ]
    },
    {
      "dsId": "v1e6db5955b28425c8da6f9a",
      "name": "CDASH_LB",
      "fields": [
        { "name": "研究中心", "type": "STRING", "seqNo": 0 },
        { "name": "中心编号", "type": "LONG", "seqNo": 1 },
        { "name": "受试者", "type": "STRING", "seqNo": 2 },
        { "name": "访视名称", "type": "STRING", "seqNo": 3 },
        { "name": "访视OID", "type": "STRING", "seqNo": 4 },
        { "name": "页面名称", "type": "STRING", "seqNo": 5 },
        { "name": "记录号", "type": "LONG", "seqNo": 6 },
        { "name": "采样日期", "type": "DATE", "seqNo": 7 },
        { "name": "检查项目", "type": "STRING", "seqNo": 8 },
        { "name": "检查结果", "type": "STRING", "seqNo": 9 },
        { "name": "单位", "type": "STRING", "seqNo": 10 },
        { "name": "下限", "type": "DOUBLE", "seqNo": 11 },
        { "name": "上限", "type": "DOUBLE", "seqNo": 12 },
        { "name": "基线数据", "type": "DOUBLE", "seqNo": 13 }
      ]
    },
    {
      "dsId": "d1eb397adbf35428eaa15793",
      "name": "CDASH_DM",
      "fields": [
        { "name": "研究中心", "type": "STRING", "seqNo": 0 },
        { "name": "中心编号", "type": "LONG", "seqNo": 1 },
        { "name": "项目", "type": "STRING", "seqNo": 2 },
        { "name": "方案编号", "type": "STRING", "seqNo": 3 },
        { "name": "受试者", "type": "STRING", "seqNo": 4 },
        { "name": "受试者状态", "type": "STRING", "seqNo": 5 },
        { "name": "页面名称", "type": "STRING", "seqNo": 6 },
        { "name": "出生日期", "type": "DATE", "seqNo": 7 },
        { "name": "年龄", "type": "LONG", "seqNo": 8 },
        { "name": "年龄_UNIT", "type": "STRING", "seqNo": 9 },
        { "name": "性别", "type": "STRING", "seqNo": 10 },
        { "name": "民族", "type": "STRING", "seqNo": 11 },
        { "name": "身高", "type": "LONG", "seqNo": 12 },
        { "name": "身高_UNIT", "type": "STRING", "seqNo": 13 },
        { "name": "WEIGHT", "type": "DOUBLE", "seqNo": 14 },
        { "name": "WEIGHT_UNIT", "type": "STRING", "seqNo": 15 },
        { "name": "受试者情况", "type": "STRING", "seqNo": 16 },
        { "name": "年龄分组（n, %）", "type": "STRING", "seqNo": 17 },
        { "name": "AGE-N(Nmiss)", "type": "LONG", "seqNo": 18 },
        { "name": "AGE-Mean±Std", "type": "LONG", "seqNo": 19 },
        { "name": "AGE-M (Q1~Q3)", "type": "LONG", "seqNo": 20 },
        { "name": "AGE-Min~Max", "type": "LONG", "seqNo": 21 },
        { "name": "诊断", "type": "STRING", "seqNo": 22 },
        { "name": "现阶段分期", "type": "STRING", "seqNo": 23 },
        { "name": "ECOG评分", "type": "LONG", "seqNo": 24 },
        { "name": "转移器官数量", "type": "STRING", "seqNo": 25 },
        { "name": "PD-L1表达状态", "type": "STRING", "seqNo": 26 }
      ]
    }
  ],
  "outputs": [],
  "platform": "bi"
}